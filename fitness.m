function [fit, h, g, objval]  = fitness(p, problem, mu, A)
    % Benchmark in CEC 2006
    popsize = size(p, 1);
    switch problem
        case 1
            fit = zeros(popsize, 10);
            g1 = 2 * p(:, 1) + 2 * p(:, 2) + p(:, 10) + p(:, 11) - 10;
            g2 = 2 * p(:, 1) + 2 * p(:, 3) + p(:, 10) + p(:, 12) - 10;
            g3 = 2 * p(:, 2) + 2 * p(:, 3) + p(:, 11) + p(:, 12) - 10;
            g4 = -8 * p(:, 1) + p(:, 10);
            g5 = -8 * p(:, 2) + p(:, 11);
            g6 = -8 * p(:, 3) + p(:, 12);
            g7 = -2 * p(:, 4) - p(:, 5) + p(:, 10);
            g8 = -2 * p(:, 6) - p(:, 7) + p(:, 11);
            g9 = -2 * p(:, 8) - p(:, 9) + p(:, 12);
            fit(:, 1) = 5 * sum(p(:, 1 : 4), 2) - 5 * sum(p(:, 1 : 4).^2, 2)-sum(p(:, 5 : 13), 2);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8, g9];
            g= [g1, g2, g3, g4, g5, g6, g7, g8, g9];
            h=[];
        case 2
            fit = zeros(popsize, 3);
            g1 = 0.75 - prod(p, 2);
            g2 = sum(p')' - 7.5 * size(p, 2);
            fit(:, 1) = -abs(sum((cos(p).^4), 2) - 2 * prod((cos(p).^2), 2))./...
                (sqrt(sum(((ones(size(p, 1), 1) * [1 : size(p, 2)]) .* (p.^2)), 2)) + 1e-17);
            fit(:, 2 : end) = [g1, g2];
            g = [g1, g2];
            h=[];

        case 3
            fit = zeros(popsize, 3);
            h1 = sum(p.^2, 2) - 1 - mu;
            h2 = -sum(p.^2, 2) + 1 - mu;
            fit(:, 1) = -(size(p,2).^0.5)^size(p,2) * prod(p, 2);
            fit(:, 2 : end) = [h1, h2];
            h=[h1,h2];
            g=[];

        case 4
            fit = zeros(popsize, 7);
            g1 =  + 85.334407 + 0.0056858 * p(:, 2) .* p(:, 5) + 0.0006262 * p(:, 1) .* p(:, 4) - 0.0022053 * p(:, 3) .* p(:, 5) - 92;
            g2 = -85.334407 - 0.0056858 * p(:, 2) .* p(:, 5) - 0.0006262 * p(:, 1) .* p(:, 4) + 0.0022053 * p(:, 3) .* p(:, 5);
            g3 =  + 80.51249 + 0.0071317 * p(:, 2) .* p(:, 5) + 0.0029955 * p(:, 1) .* p(:, 2) + 0.0021813 * p(:, 3).^2 - 110;
            g4 = -80.51249 - 0.0071317 * p(:, 2) .* p(:, 5) - 0.0029955 * p(:, 1) .* p(:, 2) - 0.0021813 * p(:, 3).^2 + 90;
            g5 =  + 9.300961 + 0.0047026 * p(:, 3) .* p(:, 5) + 0.0012547 * p(:, 1) .* p(:, 3) + 0.0019085 * p(:, 3) .* p(:, 4) - 25;
            g6 = -9.300961 - 0.0047026 * p(:, 3) .* p(:, 5) - 0.0012547 * p(:, 1) .* p(:, 3) - 0.0019085 * p(:, 3) .* p(:, 4) + 20;
            fit(:, 1) = 5.3578547 * p(:, 3).^2 + 0.8356891 * p(:, 1) .* p(:, 5) + 37.293239 * p(:, 1) - 40792.141;
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6];
            g= [g1, g2, g3, g4, g5, g6];
            h=[];

        case 5
            fit = zeros(popsize, 9);
            g1 = -p(:, 4) + p(:, 3) - 0.55;
            g2 = -p(:, 3) + p(:, 4) - 0.55;
            g3 = 1000 * sin(-p(:, 3) - 0.25) + 1000 * sin(-p(:, 4) - 0.25) + 894.8 - p(:, 1) - mu;
            g4 = 1000 * sin(p(:, 3) - 0.25) + 1000 * sin(p(:, 3) - p(:, 4)-0.25) + 894.8 - p(:, 2) - mu;
            g5 = 1000 * sin(p(:, 4) - 0.25) + 1000 * sin(p(:, 4) - p(:, 3)-0.25) + 1294.8 - mu;
            g6 = -(1000 * sin(-p(:, 3) - 0.25) + 1000 * sin(-p(:, 4) - 0.25) + 894.8 - p(:, 1)) - mu;
            g7 = -(1000 * sin(p(:, 3) - 0.25) + 1000 * sin(p(:, 3) - p(:, 4) - 0.25) + 894.8-p(:, 2)) - mu;
            g8 = -(1000 * sin(p(:, 4) - 0.25) + 1000 * sin(p(:, 4) - p(:, 3) - 0.25) + 1294.8) - mu;
            fit(:, 1) = 3 * p(:, 1) + 0.000001 * p(:, 1).^3 + 2 * p(:, 2) + 0.000002/3 * p(:, 2).^3;
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8];
            g=[g1,g2];
            h=[g3, g4, g5, g6, g7, g8];
        case 6
            fit = zeros(popsize, 3);
            g1 = -(p(:, 1) - 5).^2 - (p(:, 2) - 5).^2 + 100;
            g2 = (p(:, 1) - 6).^2 + (p(:, 2) - 5).^2-82.81;
            fit(:, 1) = (p(:, 1) - 10).^3 + (p(:, 2) - 20).^3;
            fit(:, 2 : end) = [g1, g2];
            g=[g1,g2];
            h=[];

        case 7
            fit = zeros(popsize, 9);
            g1 = -105 + 4 * p(:, 1) + 5 * p(:, 2) - 3 * p(:, 7) + 9 * p(:, 8);
            g2 = 10 * p(:, 1)-8 * p(:, 2) - 17 * p(:, 7) + 2 * p(:, 8);
            g3 = -8 * p(:, 1) + 2 * p(:, 2) + 5 * p(:, 9)-2 * p(:, 10) - 12;
            g4 = 3 * (p(:, 1)-2).^2 + 4 * (p(:, 2)-3).^2 + 2 * p(:, 3).^2 - 7 * p(:, 4) -120;
            g5 = 5 * p(:, 1).^2 + 8 * p(:, 2) + (p(:, 3)-6).^2-2 * p(:, 4) - 40;
            g6 = p(:, 1).^2 + 2 * (p(:, 2) - 2).^2 - 2 * p(:, 1) .* p(:, 2) + 14 * p(:, 5) - 6 * p(:, 6);
            g7 = 0.5 * (p(:, 1) - 8).^2 + 2 * (p(:, 2) - 4).^2 + 3 * p(:, 5).^2 - p(:, 6) - 30;
            g8 = -3 * p(:, 1) + 6 * p(:, 2) + 12 * (p(:, 9) - 8).^2 - 7 * p(:, 10);
            fit(:, 1) = p(:, 1).^2 + p(:, 2).^2 + p(:, 1) .* p(:, 2) - 14 * p(:, 1) - 16 * p(:, 2) + (p(:, 3) - 10).^2 + 4 * (p(:, 4) - 5).^2 + (p(:, 5) - 3).^2 + 2 * (p(:, 6) - 1).^2 + 5 * p(:, 7).^2 + 7 * (p(:, 8) - 11).^2 + 2 * (p(:, 9) - 10).^2 + (p(:, 10) - 7).^2 + 45;
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8];
            g=[g1, g2, g3, g4, g5, g6, g7, g8];
            h=[];

        case 8
            fit = zeros(popsize, 3);
            g1 = p(:, 1).^2 - p(:, 2) + 1;
            g2 = 1 - p(:, 1) + (p(:, 2) - 4).^2;
            fit(:, 1) = -(sin(2 * pi * p(:, 1)).^3) .* sin(2 * pi * p(:, 2))./((p(:, 1).^3 .* (p(:, 1) + p(:, 2))) + 1e-17);
            fit(:, 2 : end) = [g1, g2];
            g=[g1,g2];
            h=[];

        case 9
            fit = zeros(popsize, 5);
            g1 = -127 + 2 * p(:, 1).^2 + 3 * p(:, 2).^4 + p(:, 3) + 4 * p(:, 4).^2 + 5 * p(:, 5);
            g2 = -282 + 7 * p(:, 1) + 3 * p(:, 2) + 10 * p(:, 3).^2 + p(:, 4) - p(:, 5);
            g3 = -196 + 23 * p(:, 1) + p(:, 2).^2 + 6 * p(:, 6).^2 - 8 * p(:, 7);
            g4 = 4 * p(:, 1).^2 + p(:, 2).^2 - 3 * p(:, 1) .* p(:, 2) + 2 * p(:, 3).^2 + 5 * p(:, 6) - 11 * p(:, 7);
            fit(:, 1) = (p(:, 1) - 10).^2 + 5 * (p(:, 2) - 12).^2 + p(:, 3).^4 + 3 * (p(:, 4) - 11).^2 + 10 * p(:, 5).^6 + 7 * p(:, 6).^2 + p(:, 7).^4 - 4 * p(:, 6) .* p(:, 7) - 10 * p(:, 6) - 8 * p(:, 7);
            fit(:, 2 : end) = [g1, g2, g3, g4];
            g=[g1, g2, g3, g4];
            h=[];

        case 10
            fit = zeros(popsize, 7);
            g1 = -1 + 0.0025 * (p(:, 4) + p(:, 6));
            g2 = -1 + 0.0025 * (p(:, 5) + p(:, 7) - p(:, 4));
            g3 = -1 + 0.01 * (p(:, 8) - p(:, 5));
            g4 = -p(:, 1) .* p(:, 6) + 833.33252 * p(:, 4) + 100 * p(:, 1) - 83333.333;
            g5 = -p(:, 2) .* p(:, 7) + 1250 * p(:, 5) + p(:, 2) .* p(:, 4) - 1250 * p(:, 4);
            g6 = -p(:, 3) .* p(:, 8) + 1250000 + p(:, 3) .* p(:, 5) - 2500 * p(:, 5);
            fit(:, 1) = p(:, 1) + p(:, 2) + p(:, 3);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6];
            g= [g1, g2, g3, g4, g5, g6];
            h=[];
        case 11
            fit = zeros(popsize, 3);
            g1 = p(:, 2)-p(:, 1).^2 - mu;
            g2 = -(p(:, 2)-p(:, 1).^2) - mu;
            fit(:, 1) = p(:, 1).^2 + (p(:, 2) - 1).^2;
            fit(:, 2 : end) = [g1, g2];
            g=[];
            h=[g1,g2];

        case 12
            fit = zeros(popsize, 2);
            fit(:, 1) = -(100 - (p(:, 1) - 5).^2-(p(:, 2) - 5).^2 - (p(:, 3) - 5).^2)/100;
            for j = 1 : popsize
                fit(j, 2) = min(sum((ones(9 * 9 * 9, 1) * p(j, :) - A).^2, 2)) - 0.0625;
            end
            g=fit(:, 2);
            h=[];
        case 13
            fit = zeros(popsize, 7);
            g1 = p(:, 1).^2 + p(:, 2).^2 + p(:, 3).^2 + p(:, 4).^2 + p(:, 5).^2 - 10 - mu;
            g2 = p(:, 2) .* p(:, 3) - 5 * p(:, 4) .* p(:, 5) - mu;
            g3 = p(:, 1).^3 + p(:, 2).^3 + 1 - mu;
            g4 = -(p(:, 1).^2 + p(:, 2).^2 + p(:, 3).^2 + p(:, 4).^2 + p(:, 5).^2 - 10) - mu;
            g5 = -(p(:, 2) .* p(:, 3)-5 * p(:, 4) .* p(:, 5)) - mu;
            g6 = -(p(:, 1).^3 + p(:, 2).^3 + 1) - mu;
            fit(:, 1) = exp(p(:, 1) .* p(:, 2) .* p(:, 3) .* p(:, 4) .* p(:, 5));
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6];
            g=[];
            h=[g1, g2, g3, g4, g5, g6];

        case 14
            fit = zeros(popsize, 7);
            c = [-6.089 -17.164 -34.054 -5.914 -24.721 -14.986 -24.1 -10.708 -26.662 -22.179];
            g1 = (p(:, 1) + 2 * p(:, 2) + 2 * p(:, 3) + p(:, 6) + p(:, 10) - 2) - mu;
            g2 = (p(:, 4) + 2 * p(:, 5) + p(:, 6) + p(:, 7) - 1) - mu;
            g3 = (p(:, 3) + p(:, 7) + p(:, 8) + 2 * p(:, 9) + p(:, 10) - 1) - mu;
            g4 = -(p(:, 1) + 2 * p(:, 2) + 2 * p(:, 3) + p(:, 6) + p(:, 10) - 2) - mu;
            g5 = -(p(:, 4) + 2 * p(:, 5) + p(:, 6) + p(:, 7) - 1) - mu;
            g6 = -(p(:, 3) + p(:, 7) + p(:, 8) + 2 * p(:, 9) + p(:, 10) - 1) - mu;
            fit(:, 1) = sum(p .* (repmat(c, popsize, 1) + log(p./repmat(sum(p, 2), 1, 10))), 2);
            fit(:, 2 : end) = [g1, g2, g3,g4,g5,g6];
            h=[g1, g2, g3, g4, g5, g6];
            g=[];


        case 15
            fit = zeros(popsize, 5);
            g1 = (p(:, 1).^2 + p(:, 2).^2 + p(:, 3).^2 - 25) - mu;
            g2 = (8 * p(:, 1) + 14 * p(:, 2) + 7 * p(:, 3) - 56) - mu;
            g3 = -(p(:, 1).^2 + p(:, 2).^2 + p(:, 3).^2 - 25) - mu;
            g4 = -(8 * p(:, 1) + 14 * p(:, 2) + 7 * p(:, 3) - 56) - mu;
            fit(:, 1) = 1000 - p(:, 1).^2 - 2 * p(:, 2).^2 - p(:, 3).^2 - p(:, 1) .* p(:, 2) - p(:, 1) .* p(:, 3);
            fit(:, 2 : end) = [g1, g2, g3, g4];
            h=[g1, g2, g3, g4];
            g=[];

        case 16
            fit = zeros(popsize, 39);
            y1 = p(:, 2) + p(:, 3) + 41.6;
            c1 = 0.024 * p(:, 4)-4.62;
            y2 = 12.5./c1 + 12;
            c2 = 0.0003535 * p(:, 1).^2 + 0.5311 * p(:, 1) + 0.08705 * y2 .* p(:, 1);
            c3 = 0.052 * p(:, 1) + 78 + 0.002377 * y2 .* p(:, 1);
            y3 = c2./c3;
            y4 = 19 * y3;
            c4 = 0.04782 * (p(:, 1)-y3) + 0.1956 * (p(:, 1)-y3).^2./p(:, 2) + 0.6376 * y4 + 1.594 * y3;
            c5 = 100 * p(:, 2);
            c6 = p(:, 1) - y3 - y4;
            c7 = 0.950 - c4./c5;
            y5 = c6 .* c7;
            y6 = p(:, 1) - y5 - y4 - y3;
            c8 = (y5 + y4) * 0.995;
            y7 = c8./y1;
            y8 = c8/3798;
            c9 = y7-0.0663 * y7./y8 - 0.3153;
            y9 = 96.82./c9 + 0.321 * y1;
            y10 = 1.29 * y5 + 1.258 * y4 + 2.29 * y3 + 1.71 * y6;
            y11  =  1.71  *  p(:, 1) - 0.452  *  y4  +  0.580  *  y3;
            c10  =  12.3 / 752.3;
            c11  =  1.75  *  y2 .* 0.995 .*  p(:, 1);
            c12  =  0.995  *  y10  +  1998.0;
            y12  =  c10 * p(:, 1)  +  (c11./ c12);
            y13  =  c12 - 1.75  * y2;
            y14 =  3623.0  +  64.4  * p(:, 2)  +  58.4  *  p(:, 3)  +  (146312.0./ (y9  +  p(:, 5)));
            c13  =  0.995  *  y10  +  60.8  *  p(:, 2)  +  48  *  p(:, 4) - 0.1121  *  y14 - 5095.0;
            y15  =  y13./ c13;
            y16 =  148000.0 - 331000.0  *  y15  +  40.0  *  y13 - 61.0  .* y15 .* y13;
            c14  =  2324  *  y10 - 28740000  *  y2;
            y17  =  14130000 - 1328.0  *  y10 - 531.0  *  y11  +  (c14./c12);
            c15  =  (y13./y15) - (y13/ 0.52);
            c16  =  1.104 - 0.72  *  y15;
            c17 =  y9  +  p(:, 5);

            g1 = 0.28/0.72 .* y5 - y4;
            g2 = p(:, 3)-1.5 * p(:, 2);
            g3 = 3496 .* y2./c12 - 21;
            g4 = 110.6 + y1-62212./c17;
            g5 = 213.1 - y1;
            g6 = y1-405.23;
            g7 = 17.505 - y2;
            g8 = y2-1053.6667;
            g9 = 11.275 - y3;
            g10 = y3 - 35.03;
            g11 = 214.228 - y4;
            g12 = y4 - 665.585;
            g13 = 7.458 - y5;
            g14 = y5 - 584.463;
            g15 = 0.961 - y6;
            g16 = y6 - 265.916;
            g17 = 1.612 - y7;
            g18 = y7 - 7.046;
            g19 = 0.146 - y8;
            g20 = y8 - 0.222;
            g21 = 107.99 - y9;
            g22 = y9 - 273.366;
            g23 = 922.693 - y10;
            g24 = y10 - 1286.105;
            g25 = 926.832 - y11;
            g26 = y11 - 1444.046;
            g27 = 18.766 - y12;
            g28 = y12 - 537.141;
            g29 = 1072.163 - y13;
            g30 = y13 - 3247.039;
            g31 = 8961.448 - y14;
            g32 = y14 - 26844.086;
            g33 = 0.063 - y15;
            g34 = y15 - 0.386;
            g35 = 71084.33 - y16;
            g36 = -140000 + y16;
            g37 = 2802713 - y17;
            g38 = y17 - 12146108;
            fit(:, 1) = 0.000117  * y14 + 0.1365  +  0.00002358  *  y13  +  0.000001502  *  y16  +  0.0321  *  y12 ...
                +  0.004324  *  y5  +  0.0001  *  (c15 ./ c16)  +  37.48  *  (y2./c12) - 0.0000005843  *  y17;
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26, g27, g28, g29, g30, g31, g32, g33, g34, g35, g36, g37, g38];
            g=[g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26, g27, g28, g29, g30, g31, g32, g33, g34, g35, g36, g37, g38];
            h=[];
        case 17
            fit = zeros(popsize, 9);
            g1 = (-p(:, 1) + 300-p(:, 3) .* p(:, 4)./131.078 .* cos(1.48477-p(:, 6)) + 0.90798 .* p(:, 3).^2./131.078 .* cos(1.47588)) - mu;
            g2 = (-p(:, 2)-p(:, 3) .* p(:, 4)./131.078 .* cos(1.48477 + p(:, 6)) + 0.90798 .* p(:, 4).^2./131.078 .* cos(1.47588)) - mu;
            g3 = (-p(:, 5)-p(:, 3) .* p(:, 4)./131.078 .* sin(1.48477 + p(:, 6)) + 0.90798 .* p(:, 4).^2./131.078 .* sin(1.47588)) - mu;
            g4 = (200-p(:, 3) .* p(:, 4)./131.078 .* sin(1.48477-p(:, 6)) + 0.90798 .* p(:, 3).^2./131.078 .* sin(1.47588)) - mu;
            g5 = -(-p(:, 1) + 300-p(:, 3) .* p(:, 4)./131.078 .* cos(1.48477-p(:, 6)) + 0.90798 .* p(:, 3).^2./131.078 .* cos(1.47588)) - mu;
            g6 = -(-p(:, 2)-p(:, 3) .* p(:, 4)./131.078 .* cos(1.48477 + p(:, 6)) + 0.90798 .* p(:, 4).^2./131.078 .* cos(1.47588)) - mu;
            g7 = -(-p(:, 5)-p(:, 3) .* p(:, 4)./131.078 .* sin(1.48477 + p(:, 6)) + 0.90798 .* p(:, 4).^2./131.078 .* sin(1.47588)) - mu;
            g8 = -(200-p(:, 3) .* p(:, 4)./131.078 .* sin(1.48477-p(:, 6)) + 0.90798 .* p(:, 3).^2./131.078 .* sin(1.47588)) - mu;
            fit(:, 1) = 30 .* p(:, 1) .* (p(:, 1) < 300) + 31 .* p(:, 1) .* (p(:, 1) >= 300) + 28 .* p(:, 2) .* (p(:, 2) < 100) + 29 .* p(:, 2) .* (p(:, 2) >= 100&p(:, 2) < 200) + 30 .* p(:, 2) .* (p(:, 2) >= 200&p(:, 2) < 1000);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8];
            h=[g1, g2, g3, g4, g5, g6, g7, g8];
            g=[];
        case 18
            fit = zeros(popsize, 14);
            g1 = p(:, 3).^2 + p(:, 4).^2 - 1;
            g2 = p(:, 9).^2 - 1;
            g3 = p(:, 5).^2 + p(:, 6).^2 - 1;
            g4 = p(:, 1).^2 + (p(:, 2)-p(:, 9)).^2-1;
            g5 = (p(:, 1) - p(:, 5)).^2 + (p(:, 2) - p(:, 6)).^2 - 1;
            g6 = (p(:, 1) - p(:, 7)).^2 + (p(:, 2) - p(:, 8)).^2 - 1;
            g7 = (p(:, 3)-p(:, 5)).^2 + (p(:, 4) - p(:, 6)).^2 - 1;
            g8 = (p(:, 3)-p(:, 7)).^2 + (p(:, 4) - p(:, 8)).^2 - 1;
            g9 = p(:, 7).^2 + (p(:, 8) - p(:, 9)).^2 - 1;
            g10 = p(:, 2) .* p(:, 3) - p(:, 1) .* p(:, 4);
            g11 = -p(:, 3) .* p(:, 9);
            g12 = p(:, 5) .* p(:, 9);
            g13 = p(:, 6) .* p(:, 7) - p(:, 5) .* p(:, 8);
            fit(:, 1) = -0.5 * (p(:, 1) .* p(:, 4) - p(:, 2) .* p(:, 3) + p(:, 3) .* p(:, 9) - p(:, 5) .* p(:, 9) + p(:, 5) .* p(:, 8) - p(:, 6) .* p(:, 7));
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13];
            g=[g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13];
            h=[];
        case 19
            fit = zeros(popsize, 6);
            a = [-16 2 0 1 0;
                0 -2 0 0.4 2;
                -3.5 0 2 0 0;
                0 -2 0 -4 -1;
                0 -9 -2 1 -2.8;
                2 0 -4 0 0;
                -1 -1 -1 -1 -1;
                -1 -2 -3 -2 -1;
                1 2 3 4 5;
                1 1 1 1 1];
            b = [-40 -2 -0.25 -4 -4 -1 -20 -60 5 1];
            c = [30 -20 -10 32 -10;
                -20 39 -6 -31 32;
                -10 -6 10 -6 -10;
                32 -31 -6 39 -20;
                -10 32 -10 -20 30];
            d = [4 8 10 6 2];
            e = [-15 -27 -36 -18 -12];
            g1 = -2 * sum(repmat(c(1:5, 1)', popsize, 1) .* p(:, 11:15), 2) - 3 * d(1) .* p(:, 11).^2 - e(1) + sum(repmat(a(1:10, 1)', popsize, 1) .* p(:, 1:10), 2);
            g2 = -2 * sum(repmat(c(1:5, 2)', popsize, 1) .* p(:, 11:15), 2) - 3 * d(2) .* p(:, 12).^2 - e(2) + sum(repmat(a(1:10, 2)', popsize, 1) .* p(:, 1:10), 2);
            g3 = -2 * sum(repmat(c(1:5, 3)', popsize, 1) .* p(:, 11:15), 2) - 3 * d(3) .* p(:, 13).^2 - e(3) + sum(repmat(a(1:10, 3)', popsize, 1) .* p(:, 1:10), 2);
            g4 = -2 * sum(repmat(c(1:5, 4)', popsize, 1) .* p(:, 11:15), 2) - 3 * d(4) .* p(:, 14).^2 - e(4) + sum(repmat(a(1:10, 4)', popsize, 1) .* p(:, 1:10), 2);
            g5 = -2 * sum(repmat(c(1:5, 5)', popsize, 1) .* p(:, 11:15), 2) - 3 * d(5) .* p(:, 15).^2 - e(5) + sum(repmat(a(1:10, 5)', popsize, 1) .* p(:, 1:10), 2);
            fit(:, 1) = sum(repmat(c(1:5, 1)', popsize, 1) .* p(:, 11:15), 2) .* p(:, 11) + sum(repmat(c(1:5, 2)', popsize, 1) .* p(:, 11:15), 2) .* p(:, 12)...
                + sum(repmat(c(1:5, 3)', popsize, 1) .* p(:, 11:15), 2) .* p(:, 13) + sum(repmat(c(1:5, 4)', popsize, 1) .* p(:, 11:15), 2) .* p(:, 14)...
                + sum(repmat(c(1:5, 5)', popsize, 1) .* p(:, 11:15), 2) .* p(:, 15) + 2 * sum(repmat(d, popsize, 1) .* p(:, 11:15).^3, 2)...
                -sum(repmat(b, popsize, 1) .* p(:, 1:10), 2);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5];
            g=[g1, g2, g3, g4, g5];
            h=[];
        case 20
            fit = zeros(popsize, 35);
            a = [0.0693 0.0577 0.05 0.2 0.26 0.55 0.06 0.1 0.12 0.18 0.1 0.09...
                0.0693 0.0577 0.05 0.2 0.26 0.55 0.06 0.1 0.12 0.18 0.1 0.09];
            b = [44.094 58.12 58.12 137.4 120.9 170.9 62.501 84.94 133.425 82.507 46.07 60.097...
                44.094 58.12 58.12 137.4 120.9 170.9 62.501 84.94 133.425 82.507 46.07 60.079];
            c = [123.7 31.7 45.7 14.7 84.7 27.7 49.7 7.1 2.1 17.7 0.85 0.64];
            d = [31.244 36.12 34.784 92.7 82.7 91.6 56.708 82.7 80.8 64.517 49.4 49.1];
            e = [0.1 0.3 0.4 0.3 0.6 0.3];
            g1 = (p(:, 1) + p(:, 13))./(sum(p, 2) + e(1));
            g2 = (p(:, 2) + p(:, 14))./(sum(p, 2) + e(2));
            g3 = (p(:, 3) + p(:, 15))./(sum(p, 2) + e(3));
            g4 = (p(:, 7) + p(:, 19))./(sum(p, 2) + e(4));
            g5 = (p(:, 8) + p(:, 20))./(sum(p, 2) + e(5));
            g6 = (p(:, 9) + p(:, 21))./(sum(p, 2) + e(6));
            g7 = (p(:, 13)./(b(13) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(1) * p(:, 1)./(40 * b(1) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g8 = (p(:, 14)./(b(14) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(2) * p(:, 2)./(40 * b(2) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g9 = (p(:, 15)./(b(15) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(3) * p(:, 3)./(40 * b(3) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g10 = (p(:, 16)./(b(16) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(4) * p(:, 4)./(40 * b(4) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g11 = (p(:, 17)./(b(17) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(5) * p(:, 5)./(40 * b(5) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g12 = (p(:, 18)./(b(18) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(6) * p(:, 6)./(40 * b(6) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g13 = (p(:, 19)./(b(19) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(7) * p(:, 7)./(40 * b(7) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g14 = (p(:, 20)./(b(20) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(8) * p(:, 8)./(40 * b(8) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g15 = (p(:, 21)./(b(21) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(9) * p(:, 9)./(40 * b(9) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g16 = (p(:, 22)./(b(22) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(10) * p(:, 10)./(40 * b(10) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g17 = (p(:, 23)./(b(23) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(11) * p(:, 11)./(40 * b(11) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g18 = (p(:, 24)./(b(24) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(12) * p(:, 12)./(40 * b(12) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g19 = (sum(p, 2) - 1) - mu;
            g20 = (sum(p(:, 1:12)./repmat(d(1 : 12), popsize, 1), 2) + 0.7302 * 530 * 14.7/40 * sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2) - 1.671) - mu;
            g21 = -(p(:, 13)./(b(13) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(1) * p(:, 1)./(40 * b(1) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g22 = -(p(:, 14)./(b(14) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(2) * p(:, 2)./(40 * b(2) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g23 = -(p(:, 15)./(b(15) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(3) * p(:, 3)./(40 * b(3) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g24 = -(p(:, 16)./(b(16) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(4) * p(:, 4)./(40 * b(4) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g25 = -(p(:, 17)./(b(17) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(5) * p(:, 5)./(40 * b(5) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g26 = -(p(:, 18)./(b(18) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(6) * p(:, 6)./(40 * b(6) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g27 = -(p(:, 19)./(b(19) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(7) * p(:, 7)./(40 * b(7) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g28 = -(p(:, 20)./(b(20) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(8) * p(:, 8)./(40 * b(8) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g29 = -(p(:, 21)./(b(21) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(9) * p(:, 9)./(40 * b(9) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g30 = -(p(:, 22)./(b(22) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(10) * p(:, 10)./(40 * b(10) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g31 = -(p(:, 23)./(b(23) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(11) * p(:, 11)./(40 * b(11) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g32 = -(p(:, 24)./(b(24) * (sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2))) - c(12) * p(:, 12)./(40 * b(12) * (sum(p(:, 1:12)./repmat(b(1:12), popsize, 1), 2)))) - mu;
            g33 = -(sum(p, 2) - 1) - mu;
            g34 = -(sum(p(:, 1:12)./repmat(d(1 : 12), popsize, 1), 2) + 0.7302 * 530 * 14.7/40 * sum(p(:, 13:24)./repmat(b(13:24), popsize, 1), 2) - 1.671) - mu;
            fit(:, 1) = sum(repmat(a, popsize, 1) .* p, 2);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26, g27, g28, g29, g30, g31, g32, g33, g34];
            h=[g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26, g27, g28, g29, g30, g31, g32, g33, g34];
            g=[g1, g2, g3, g4, g5, g6];
        case 21
            fit = zeros(popsize, 12);
            g1 = -p(:, 1) + 35 * p(:, 2).^0.6 + 35 * p(:, 3).^0.6;
            g2 = (-300 * p(:, 3) + 7500 * p(:, 5)-7500 * p(:, 6) - 25 * p(:, 4) .* p(:, 5) + 25 * p(:, 4) .* p(:, 6) + p(:, 3) .* p(:, 4)) - mu;
            g3 = (100 * p(:, 2) + 155.365 * p(:, 4) + 2500 * p(:, 7) - p(:, 2) .* p(:, 4) - 25 * p(:, 4) .* p(:, 7) - 15536.5) - mu;
            g4 = (-p(:, 5) + log(-p(:, 4) + 900)) - mu;
            g5 = (-p(:, 6) + log(p(:, 4) + 300)) - mu;
            g6 = (-p(:, 7) + log(-2 * p(:, 4) + 700)) - mu;
            g7 = -(-300 * p(:, 3) + 7500 * p(:, 5)-7500 * p(:, 6) - 25 * p(:, 4) .* p(:, 5) + 25 * p(:, 4) .* p(:, 6) + p(:, 3) .* p(:, 4)) - mu;
            g8 = -(100 * p(:, 2) + 155.365 * p(:, 4) + 2500 * p(:, 7) - p(:, 2) .* p(:, 4) - 25 * p(:, 4) .* p(:, 7) - 15536.5) - mu;
            g9 = -(-p(:, 5) + log(-p(:, 4) + 900)) - mu;
            g10 = -(-p(:, 6) + log(p(:, 4) + 300)) - mu;
            g11 = -(-p(:, 7) + log(-2 * p(:, 4) + 700)) - mu;
            fit(:, 1) = p(:, 1);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11];
            g=g1;
            h=[g2, g3, g4, g5, g6, g7, g8, g9, g10, g11];

        case 22
            fit = zeros(popsize, 40);
            g1 = -p(:, 1) + p(:, 2).^0.6 + p(:, 3).^0.6 + p(:, 4).^0.6;
            g2 = abs(p(:, 5)-100000 * p(:, 8) + 10^7) - mu;
            g3 = abs(p(:, 6) + 100000 * p(:, 8) - 100000 * p(:, 9)) - mu;
            g4 = abs(p(:, 7) + 100000 * p(:, 9) - 5 * 10^7) - mu;
            g5 = abs(p(:, 5) + 100000 * p(:, 10) - 3.3 * 10^7) - mu;
            g6 = abs(p(:, 6) + 100000 * p(:, 11) - 4.4 * 10^7) - mu;
            g7 = abs(p(:, 7) + 100000 * p(:, 12) - 6.6 * 10^7) - mu;
            g8 = abs(p(:, 5) - 120 * p(:, 2) .* p(:, 13)) - mu;
            g9 = abs(p(:, 6) - 80 * p(:, 3) .* p(:, 14)) - mu;
            g10 = abs(p(:, 7) - 40 * p(:, 4) .* p(:, 15)) - mu;
            g11 = abs(p(:, 8) - p(:, 11) + p(:, 16)) - mu;
            g12 = abs(p(:, 9) - p(:, 12) + p(:, 17)) - mu;
            g13 = abs(-p(:, 18) + log(p(:, 10) - 100)) - mu;
            g14 = abs(-p(:, 19) + log(-p(:, 8) + 300)) - mu;
            g15 = abs(-p(:, 20) + log(p(:, 16))) - mu;
            g16 = abs(-p(:, 21) + log(-p(:, 9) + 400)) - mu;
            g17 = abs(-p(:, 22) + log(p(:, 17))) - mu;
            g18 = abs(-p(:, 8) - p(:, 10) + p(:, 13) .* p(:, 18) - p(:, 13) .* p(:, 19) + 400) - mu;
            g19 = abs(p(:, 8) - p(:, 9) - p(:, 11) + p(:, 14) .* p(:, 20) - p(:, 14) .* p(:, 21) + 400) - mu;
            g20 = -(p(:, 9) - p(:, 12) - 4.60517 * p(:, 15) + p(:, 15) .* p(:, 22) + 100) - mu;
            g21 = -(p(:, 5)-100000 * p(:, 8) + 10^7) - mu;
            g22 = -(p(:, 6) + 100000 * p(:, 8) - 100000 * p(:, 9)) - mu;
            g23 = -(p(:, 7) + 100000 * p(:, 9) - 5 * 10^7) - mu;
            g24 = -(p(:, 5) + 100000 * p(:, 10) - 3.3 * 10^7) - mu;
            g25 = -(p(:, 6) + 100000 * p(:, 11) - 4.4 * 10^7) - mu;
            g26 = -(p(:, 7) + 100000 * p(:, 12) - 6.6 * 10^7) - mu;
            g27 = -(p(:, 5) - 120 * p(:, 2) .* p(:, 13)) - mu;
            g28 = -(p(:, 6) - 80 * p(:, 3) .* p(:, 14)) - mu;
            g29 = -(p(:, 7) - 40 * p(:, 4) .* p(:, 15)) - mu;
            g30 = -(p(:, 8) - p(:, 11) + p(:, 16)) - mu;
            g31 = -(p(:, 9) - p(:, 12) + p(:, 17)) - mu;
            g32 = -(-p(:, 18) + log(p(:, 10) - 100)) - mu;
            g33 = -(-p(:, 19) + log(-p(:, 8) + 300)) - mu;
            g34 = -(-p(:, 20) + log(p(:, 16))) - mu;
            g35 = -(-p(:, 21) + log(-p(:, 9) + 400)) - mu;
            g36 = -(-p(:, 22) + log(p(:, 17))) - mu;
            g37 = -(-p(:, 8) - p(:, 10) + p(:, 13) .* p(:, 18) - p(:, 13) .* p(:, 19) + 400) - mu;
            g38 = -(p(:, 8) - p(:, 9) - p(:, 11) + p(:, 14) .* p(:, 20) - p(:, 14) .* p(:, 21) + 400) - mu;
            g39 = -(p(:, 9) - p(:, 12) - 4.60517 * p(:, 15) + p(:, 15) .* p(:, 22) + 100) - mu;
            fit(:, 1) = p(:, 1);
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26, g27, g28, g29, g30, g31, g32, g33, g34, g35, g36 g37, g38, g39];
            h=[g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14, g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26, g27, g28, g29, g30, g31, g32, g33, g34, g35, g36 g37, g38, g39];
            g=g1;
        case 23
            fit = zeros(popsize, 11);
            g1 = p(:, 9) .* p(:, 3) + 0.02 .* p(:, 6) - 0.025 .* p(:, 5);
            g2 = p(:, 9) .* p(:, 4) + 0.02 .* p(:, 7) - 0.015 .* p(:, 8);
            g3 = (p(:, 1) + p(:, 2) - p(:, 3)-p(:, 4)) - mu;
            g4 = (0.03 .* p(:, 1) + 0.01 .* p(:, 2) - p(:, 9) .* (p(:, 3) + p(:, 4))) - mu;
            g5 = (p(:, 3) + p(:, 6) - p(:, 5)) - mu;
            g6 = (p(:, 4) + p(:, 7) - p(:, 8)) - mu;
            g7 = -(p(:, 1) + p(:, 2) - p(:, 3)-p(:, 4)) - mu;
            g8 = -(0.03 .* p(:, 1) + 0.01 .* p(:, 2) - p(:, 9) .* (p(:, 3) + p(:, 4))) - mu;
            g9 = -(p(:, 3) + p(:, 6) - p(:, 5)) - mu;
            g10 = -(p(:, 4) + p(:, 7) - p(:, 8)) - mu;
            fit(:, 1) = -9 .* p(:, 5) - 15 .* p(:, 8) + 6 .* p(:, 1) + 16 .* p(:, 2) + 10 .* (p(:, 6) + p(:, 7));
            fit(:, 2 : end) = [g1, g2, g3, g4, g5, g6,g7,g8,g9,g10];
            g=[g1, g2];
            h=[g3, g4, g5, g6,g7,g8,g9,g10];

        case 24
            fit = zeros(popsize, 3);
            g1 = -2 * p(:, 1).^4 + 8 * p(:, 1).^3 - 8 * p(:, 1).^2 + p(:, 2) - 2;
            g2 = -4 * p(:, 1).^4 + 32 * p(:, 1).^3 - 88 * p(:, 1).^2 + 96 * p(:, 1) + p(:, 2) - 36;
            fit(:, 1) = -p(:, 1) - p(:, 2);
            fit(:, 2 : end) = [g1, g2];
            g=[g1,g2];
            h=[];
    end
    objval=fit(:, 1);
end